<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Giải thích bài báo DEtection TRansformer | Random Thoughts
</title>
  <link rel="canonical" href="https://anhlt.github.io/End-t-End-transformer-classic-object-detection-vi.html">


  <link rel="stylesheet" href="https://anhlt.github.io/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://anhlt.github.io/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://anhlt.github.io/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="https://anhlt.github.io/theme/css/theme.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://anhlt.github.io/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://anhlt.github.io/feeds/deep-learning.atom.xml">  
  <meta name="description" content="Giới thiệu bài toán Object Detection cổ điển, từ đó nắm bắt được ý tưởng của các thuật toán Deep Learing phức tạp hơn">
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o);
      a.async = 1;
      a.src = g;
      m = s.getElementsByTagName(o)[0];
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-12027115-4', 'auto');
    ga('send', 'pageview');
  </script>


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
  <div class="col-sm-12">
    <h1 class="title"><a href="https://anhlt.github.io/">Random Thoughts</a></h1>
      <p class="text-muted">✨ Suy nghĩ vu vơ</p>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Giải thích bài báo DEtection TRansformer
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2020-06-16T19:18:33+09:00">
          <i class="fas fa-clock"></i>
          Tue 16 June 2020
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://anhlt.github.io/category/deep-learning.html">Deep Learning</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="https://anhlt.github.io/author/h4cker.html">h4cker</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://anhlt.github.io/tag/vietnamese.html">#vietnamese</a>,               <a href="https://anhlt.github.io/tag/explained.html">#explained</a>,               <a href="https://anhlt.github.io/tag/object_detection.html">#object_detection</a>,               <a href="https://anhlt.github.io/tag/transfomer.html">#transfomer</a>          </li>
      </ul>
    </header>
    <div class="content">
      <p>Từ trước đến nay bài toán object detection thường dựa vào các thuật toán thiết kế thủ công như Non-maximum Suppession, hay anchor generation để thiết kế mạng network. Bài báo này đưa ra một phương pháp mới mới gọi là "DEtection TRansformer" sử dụng kiến trúc transfomer để giải quyết bài toán object detection.</p>
<h3 id="mot-so-khai-niem">Một số khái niệm</h3>
<h4 id="hungarian-algotithm">Hungarian Algotithm</h4>
<h5 id="bai-toan">Bài toán</h5>
<div class="highlight"><pre><span></span><code>Một nhà máy có bốn nhân công thực hiện 4 công việc khác nhau trong
</code></pre></div>

<div class="math">$$
\begin{array}{llll}
30 &amp; 40 &amp; 50 &amp; 60 \\
70 &amp; 30 &amp; 40 &amp; 70 \\
60 &amp; 50 &amp; 60 &amp; 30 \\
20 &amp; 80 &amp; 50 &amp; 70
\end{array}
$$</div>
<h3 id="kien-truc-mang-detr">Kiến trúc mạng DETR</h3>
<p><img src="/images/08/network.png" width="1000" title="'DETR'" alt="'DETR'"></p>
<p>Kiến trúc mạng DETR gồm 3 thành phần chính</p>
<ol>
<li>
<p><strong>Backbone network</strong></p>
<p>Tương tự như Faster RCNN, DETR sử dụng một mạng CNN để thu được <code>convolutional features</code> của ảnh đầu vào. </p>
<p>Với mỗi ảnh đầu vào có kích thước</p>
<p>
<div class="math">$$x_{\mathrm{img}} \in \mathbb{R}^{3 \times H_{0} \times W_{0}}$$</div>
</p>
<p>thu được <code>convolutional features</code> có kích thước </p>
<p>
<div class="math">$$f \in \mathbb{R}^{C \times H \times W} $$</div>
</p>
<p>trong đó <span class="math">\(C=2048\)</span> , <span class="math">\(H, W=\frac{H_{0}}{32}, \frac{W_{0}}{32}\)</span></p>
<p><img src="/images/rpn/step-1.png" width="400" title="'Fast RCNN'" alt="'Fast RCNN'"></p>
</li>
<li>
<p><strong>Transformer encoder</strong>    </p>
<p>Ở đây, tác giả sử dụng <span class="math">\(1x1\)</span> convolution để giảm chiều <code>convolutional features</code> từ <span class="math">\(C\)</span> xuống <span class="math">\(z_{0} \in \mathbb{R}^{d \times H \times W}\)</span>. 
Bởi vì <code>encoder</code> có đầu vào dạng <code>sequence</code>, tại đây, <code>features</code> được <code>flatten</code> thành <span class="math">\(z_{0} \in \mathbb{R}^{d \times HW}\)</span> </p>
<p><img src="/images/08/step1.png" width="400" title="'Fast RCNN'" alt="'Fast RCNN'"></p>
<p><img src="/images/08/transformer.png" width="400" title="'Encoder-Decoder' | Hello" alt="'Encoder-Decoder' | Hello"></p>
</li>
</ol>
<h3 id="loss-function">Loss Function</h3>
<p>DETR cho ra output gồm N dự đoán </p>
<div class="math">$$y = N \times \left(c_{i} , b_{i}\right)$$</div>
<p>với <span class="math">\(c_{i}\)</span> là xác suất  </p>
<div class="math">$$\hat{y} = N  \times \left(c_i , b_i\right)$$</div>
<div class="math">$$
\hat{\sigma}=\underset{\sigma \in \mathfrak{S}_{N}}{\arg \min } \sum_{i}^{N} \mathcal{L}_{\mathrm{match}}\left(y_{i}, \hat{y}_{\sigma(i)}\right)
$$</div>
<h4 id="hungarian-loss">Hungarian Loss</h4>
<div class="math">$$
\mathcal{L}_{\text {Hungarian }}(y, \hat{y})=\sum_{i=1}^{N}\left[-\log \hat{p}_{\hat{\sigma}(i)}\left(c_{i}\right)+\mathbb{1}_{\left\{c_{i} \neq \varnothing\right\}} \mathcal{L}_{\mathrm{box}}\left(b_{i}, \hat{b}_{\hat{\sigma}}(i)\right)\right]
$$</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </div>
  </article>
  <hr>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function() {
      this.page.url = 'https://anhlt.github.io/End-t-End-transformer-classic-object-detection-vi.html';
      this.page.identifier = 'End-t-End-transformer-classic-object-detection';
    };
    (function() {
      var d = document;
      var s = d.createElement('script');
      s.src = '//deepmlml.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript class="text-muted">
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
  </noscript>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="https://anhlt.github.io/authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="https://anhlt.github.io/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="https://anhlt.github.io/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://anhlt.github.io/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>

</html>